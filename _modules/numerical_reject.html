

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>numerical_reject &mdash; ECMC for pure gauge LQCD 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ECMC for pure gauge LQCD
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">src</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ECMC for pure gauge LQCD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">numerical_reject</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for numerical_reject</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Generation of rejects by numerical resolution of the inversion equation. Available only for lambda_8.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">brentq</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>



<div class="viewcode-block" id="coeffs_8">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.coeffs_8">[docs]</a>
<span class="k">def</span> <span class="nf">coeffs_8</span><span class="p">(</span><span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Give the coefficients of the trigonometric function for lambda_8 (cf pdf)</span>

<span class="sd">    Args:</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Returns:</span>
<span class="sd">        (double, double, double, double): a,b,c,d coefficients (cf pdf)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">plaquette</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">plaquette</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">real</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">plaquette</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">plaquette</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">imag</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">plaquette</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">plaquette</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span></div>


<div class="viewcode-block" id="derivee_f_lambda_8">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.derivee_f_lambda_8">[docs]</a>
<span class="k">def</span> <span class="nf">derivee_f_lambda_8</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The trigonometric function of the derivative of the energy for lambda_8.</span>

<span class="sd">    Args:</span>
<span class="sd">        xi (double): angle</span>
<span class="sd">        a (double): coefficient of the trig function</span>
<span class="sd">        b (double): coefficient of the trig function</span>
<span class="sd">        c (double): coefficient of the trig function</span>
<span class="sd">        d (double): coefficient of the trig function</span>

<span class="sd">    Returns:</span>
<span class="sd">        double: derivative of the energy for lambda_8</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">a</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xi</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">+</span><span class="n">b</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">xi</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">xi</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span></div>


<div class="viewcode-block" id="coeffs_quartic">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.coeffs_quartic">[docs]</a>
<span class="k">def</span> <span class="nf">coeffs_quartic</span><span class="p">(</span><span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&quot;Return the coefficients of the numerator of the quartic equation for the derivative of the energy, with the dominant coefficient first, obtained using the change of variable t = tan(xi/(2sqrt(3))).&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: list of the polynomial coefficients </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">coeffs_8</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="n">b</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">8</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">d</span><span class="p">]</span></div>


<div class="viewcode-block" id="real_roots">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.real_roots">[docs]</a>
<span class="k">def</span> <span class="nf">real_roots</span><span class="p">(</span><span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the real roots of the numerator of the quartic equation corresponding to the derivative of the energy. The function root calculates the eigenvalues of the companion matrix associated with the polynomial.</span>

<span class="sd">    Args:</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: list of the real roots</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coeffs_q</span> <span class="o">=</span> <span class="n">coeffs_quartic</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="n">roots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">coeffs_q</span><span class="p">)</span>
    <span class="n">real_roots</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">roots</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">real_roots</span></div>


<div class="viewcode-block" id="roots_xi">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.roots_xi">[docs]</a>
<span class="k">def</span> <span class="nf">roots_xi</span><span class="p">(</span><span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the roots of the derivative of the energy for xi ranging from [0, 2pi]</span>

<span class="sd">    Args:</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: list of roots of the derivative of the energy for lambda_8, variable xi</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">real</span> <span class="o">=</span> <span class="n">real_roots</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="c1">#print(real)</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">coeffs_8</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="n">roots_xi</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">real</span><span class="p">:</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">atan</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="c1">#Car le chgt de variable est r = tan(xi/2sqrt3))</span>
        
        <span class="n">xi</span> <span class="o">=</span> <span class="n">xi</span><span class="o">%</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="c1">#Le changement de variable inverse nous donne xi modulo 2sqrt(3)pi</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">derivee_f_lambda_8</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-3</span><span class="p">):</span> <span class="c1">#on vérifie qu&#39;on a bien toujours des racines de la dérivée de l&#39;énergie</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;/!</span><span class="se">\\</span><span class="s2"> WARNING /!</span><span class="se">\\</span><span class="s2"> WARNING /!</span><span class="se">\\</span><span class="s2"> WARNING /!</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Evaluation de la racine en xi post chgt de variable : &quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">derivee_f_lambda_8</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;/!</span><span class="se">\\</span><span class="s2"> WARNING /!</span><span class="se">\\</span><span class="s2"> WARNING /!</span><span class="se">\\</span><span class="s2"> WARNING /!</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1">#raise ValueError(&quot;Le xi calculé post changement de variable inverse n&#39;est pas une racine de la dérivée de l&#39;énergie&quot;)</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">xi</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">):</span>
            <span class="n">roots_xi</span> <span class="o">+=</span> <span class="p">[</span><span class="n">xi</span><span class="p">]</span> <span class="c1">#On ne s&#39;intéresse qu&#39;aux racines entre 0 et 2pi</span>
            
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">derivee_f_lambda_8</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">:</span> <span class="c1">#on ajoute sqrt(3)pi si c&#39;est racine car ignoré par le chgt de variable (il l&#39;envoie a l&#39;infini)</span>
        <span class="n">roots_xi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    
    <span class="n">roots_xi</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span> <span class="c1">#On trie la liste par ordre croissant</span>
    
    <span class="k">return</span> <span class="n">roots_xi</span></div>


<div class="viewcode-block" id="signe_entre_racines">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.signe_entre_racines">[docs]</a>
<span class="k">def</span> <span class="nf">signe_entre_racines</span><span class="p">(</span><span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a vector of -1 and 1 depending on the sign of the derivative of the energy between the roots, only for xi between 0 and 2pi (forward crossing).</span>

<span class="sd">    Args:</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of int: list of 1 or -1 depending on the sign of the function between the roots</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">racines</span> <span class="o">=</span> <span class="n">roots_xi</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="c1"># Initialisation de la liste des signes</span>
    <span class="n">signes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">coeffs_8</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">0</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">racines</span><span class="p">:</span>
        <span class="n">racines</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">racines</span>
    <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">racines</span><span class="p">:</span>
        <span class="n">racines</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]</span>
    <span class="n">racines</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">racines</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">signes</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">derivee_f_lambda_8</span><span class="p">((</span><span class="n">racines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">racines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">signes</span></div>


<div class="viewcode-block" id="intervalle_signes">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.intervalle_signes">[docs]</a>
<span class="k">def</span> <span class="nf">intervalle_signes</span><span class="p">(</span><span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the lists of intervals where the derivative of the energy is positive and negative (useful for the return) on 0 to 2pi</span>

<span class="sd">    Args:</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of tuple, list of tuples: lists of intervals where the derivative of the energy is positive and negative </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">signes</span> <span class="o">=</span> <span class="n">signe_entre_racines</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="n">racines</span> <span class="o">=</span> <span class="n">roots_xi</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="c1">#print(racines)</span>
    <span class="n">intervalles_pos</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Liste pour les intervalles positifs</span>
    <span class="n">intervalles_neg</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Liste pour les intervalles négatifs</span>

    <span class="k">if</span> <span class="mi">0</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">racines</span><span class="p">:</span>
        <span class="n">racines</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">racines</span>
    <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">racines</span><span class="p">:</span>
        <span class="n">racines</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">]</span>
    <span class="n">racines</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">racines</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">signes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">intervalles_pos</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">racines</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">racines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])]</span>
        <span class="k">if</span> <span class="n">signes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">intervalles_neg</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">racines</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">racines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])]</span>
    
    <span class="k">return</span> <span class="n">intervalles_pos</span><span class="p">,</span> <span class="n">intervalles_neg</span></div>



<div class="viewcode-block" id="derivee_f_lambda_8_plus_aller">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.derivee_f_lambda_8_plus_aller">[docs]</a>
<span class="k">def</span> <span class="nf">derivee_f_lambda_8_plus_aller</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the max between 0 and the derivative of the energy for lambda_8 when xi(t) is moving foward 0 -&gt; 2pi</span>

<span class="sd">    Args:</span>
<span class="sd">        t (double): angle</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: t must be in [0,2pi]</span>

<span class="sd">    Returns:</span>
<span class="sd">        double: value of the function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">coeffs_8</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">0</span><span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">derivee_f_lambda_8</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;t n&#39;est pas entre 0 et 2pi&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="derivee_f_lambda_8_plus_retour">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.derivee_f_lambda_8_plus_retour">[docs]</a>
<span class="k">def</span> <span class="nf">derivee_f_lambda_8_plus_retour</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the max between 0 and the derivative of the energy for lambda_8 when xi(t) is moving backward 0 &lt;- 2pi </span>

<span class="sd">    Args:</span>
<span class="sd">        t (double): backward parametrization of xi (cf pdf xi(t)  = 4pi - t)</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: t must be in [2pi,4pi]</span>

<span class="sd">    Returns:</span>
<span class="sd">        double: value of the function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">coeffs_8</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="k">if</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">derivee_f_lambda_8</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="n">t</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;t n&#39;est pas entre 2pi et 4pi&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="derivee_f_lambda_8_plus">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.derivee_f_lambda_8_plus">[docs]</a>
<span class="k">def</span> <span class="nf">derivee_f_lambda_8_plus</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the max between 0 and the derivative of the energy for lambda_8 with parametrization xi(t) and t in 0,4pi</span>

<span class="sd">    Args:</span>
<span class="sd">        t (double): parameter for xi</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Returns:</span>
<span class="sd">        double: value of the function</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">t</span><span class="o">&lt;=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">derivee_f_lambda_8_plus_aller</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">plaquette</span><span class="p">)</span>
    <span class="k">elif</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">&lt;</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">derivee_f_lambda_8_plus_retour</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">plaquette</span><span class="p">)</span></div>


<div class="viewcode-block" id="f_8">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.f_8">[docs]</a>
<span class="k">def</span> <span class="nf">f_8</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">plaquette</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">gamma</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The function whose roots are the solutions of the inversion equation for the rejects</span>

<span class="sd">    Args:</span>
<span class="sd">        x (double): real number</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>
<span class="sd">        a (double): lower bound of the integral</span>
<span class="sd">        gamma (double): real number</span>

<span class="sd">    Returns:</span>
<span class="sd">        double: integral of max(0, derivative) - gamma</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span><span class="p">,</span><span class="o">*</span><span class="n">_</span><span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">derivee_f_lambda_8_plus</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">plaquette</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">-</span><span class="n">gamma</span></div>


<div class="viewcode-block" id="intervalles_aller_retour">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.intervalles_aller_retour">[docs]</a>
<span class="k">def</span> <span class="nf">intervalles_aller_retour</span><span class="p">(</span><span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the positive intervals for t for forward and return paths</span>

<span class="sd">    Args:</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of tuples, list of tuples: positive intervals for the foward path, positive intervals for the backwards path (for variable t)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">intervalles_pos</span><span class="p">,</span> <span class="n">intervalles_neg</span> <span class="o">=</span> <span class="n">intervalle_signes</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="n">intervalles_pos_retour</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">intervalles_neg</span><span class="p">)):</span>
        <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">intervalles_neg</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">intervalles_neg</span><span class="p">)</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#Les intervalles du retour sont dans l&#39;ordre inverse</span>
        <span class="n">intervalles_pos_retour</span> <span class="o">+=</span> <span class="p">[(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">-</span><span class="n">a</span><span class="p">)]</span> <span class="c1">#Le retour commence à 2pi</span>
    <span class="k">return</span> <span class="n">intervalles_pos</span><span class="p">,</span> <span class="n">intervalles_pos_retour</span></div>


<div class="viewcode-block" id="contrib">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.contrib">[docs]</a>
<span class="k">def</span> <span class="nf">contrib</span><span class="p">(</span><span class="n">plaquette</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the value of the integral of max(0, E&#39;+) between a and b.</span>

<span class="sd">    Args:</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>
<span class="sd">        a (double): lower bound</span>
<span class="sd">        b (double): upper bound</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: a and b must be in 0,4pi</span>

<span class="sd">    Returns:</span>
<span class="sd">        double: value of the integral</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">a</span><span class="o">&lt;=</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="ow">and</span> <span class="mi">0</span><span class="o">&lt;=</span><span class="n">b</span><span class="o">&lt;=</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
        <span class="n">R</span><span class="p">,</span><span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">derivee_f_lambda_8_plus</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">plaquette</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">R</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mauvaises bornes pour l&#39;intervalle d&#39;intégration&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="reduce_gamma_8">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.reduce_gamma_8">[docs]</a>
<span class="k">def</span> <span class="nf">reduce_gamma_8</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Takes a gamma, reduces it to its value in the contribution of the interval containing the solution, and determines the interval in which to solve the equation.</span>

<span class="sd">    Args:</span>
<span class="sd">        gamma (double): real number</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the computed bounds of the interval are in the wrong order</span>

<span class="sd">    Returns:</span>
<span class="sd">        double, double, double: reduced gamma, lower bound, upper bound</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">contrib_aller</span> <span class="o">=</span> <span class="n">contrib</span><span class="p">(</span><span class="n">plaquette</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">contrib_retour</span> <span class="o">=</span> <span class="n">contrib</span><span class="p">(</span><span class="n">plaquette</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">contrib_total</span> <span class="o">=</span> <span class="n">contrib_aller</span><span class="o">+</span><span class="n">contrib_retour</span>

    
    <span class="n">gamma_r</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">%</span><span class="n">contrib_total</span>
    <span class="n">int_aller</span><span class="p">,</span> <span class="n">int_retour</span> <span class="o">=</span> <span class="n">intervalles_aller_retour</span><span class="p">(</span><span class="n">plaquette</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span> <span class="c1">#Les  bornes de l&#39;intervalle qu&#39;on va renvoyer</span>
    <span class="k">if</span> <span class="n">gamma_r</span> <span class="o">&lt;=</span> <span class="n">contrib_aller</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">int_aller</span><span class="p">)):</span>
            <span class="n">a_i</span><span class="p">,</span> <span class="n">b_i</span> <span class="o">=</span> <span class="n">int_aller</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">gamma_r</span> <span class="o">&lt;=</span> <span class="n">contrib</span><span class="p">(</span><span class="n">plaquette</span><span class="p">,</span><span class="n">a_i</span><span class="p">,</span><span class="n">b_i</span><span class="p">)):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">a_i</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">b_i</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gamma_r</span> <span class="o">-=</span> <span class="n">contrib</span><span class="p">(</span><span class="n">plaquette</span><span class="p">,</span><span class="n">a_i</span><span class="p">,</span><span class="n">b_i</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gamma_r</span> <span class="o">-=</span> <span class="n">contrib_aller</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">int_retour</span><span class="p">)):</span>
            <span class="n">a_i</span><span class="p">,</span> <span class="n">b_i</span> <span class="o">=</span> <span class="n">int_retour</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">gamma_r</span> <span class="o">&lt;=</span> <span class="n">contrib</span><span class="p">(</span><span class="n">plaquette</span><span class="p">,</span><span class="n">a_i</span><span class="p">,</span><span class="n">b_i</span><span class="p">)):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">a_i</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">b_i</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">gamma_r</span> <span class="o">-=</span> <span class="n">contrib</span><span class="p">(</span><span class="n">plaquette</span><span class="p">,</span><span class="n">a_i</span><span class="p">,</span><span class="n">b_i</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">b</span><span class="o">&lt;</span><span class="n">a</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Intervalle dans le mauvais sens&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">gamma_r</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span></div>


<div class="viewcode-block" id="solve_8">
<a class="viewcode-back" href="../numerical_reject.html#numerical_reject.solve_8">[docs]</a>
<span class="k">def</span> <span class="nf">solve_8</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">plaquette</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Solves the inversion equation for lambda_8 for a given number on the rhs of the inversion equation and a given plaquette</span>

<span class="sd">    Args:</span>
<span class="sd">        gamma (double): the rhs of the inversion equation</span>
<span class="sd">        plaquette (numpy.array): 3x3 SU(3) matrix</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: the numerically computed reject angle is not right (we don&#39;t retrieve gamma)</span>

<span class="sd">    Returns:</span>
<span class="sd">        double: solution of the inversion equation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">gamma_r</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span> <span class="n">reduce_gamma_8</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span><span class="n">plaquette</span><span class="p">)</span>
    
    <span class="c1">#try:</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="n">brentq</span><span class="p">(</span><span class="n">f_8</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">plaquette</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">gamma_r</span><span class="p">))</span>
    
    <span class="c1">#On vérifie que la solution calculée nous donne bien le gamma réduit</span>
    <span class="c1">#On coupe l&#39;intégrale en 2 pour éviter la discontinuité en 2pi qui met un message d&#39;avertissement</span>
    <span class="n">contrib_aller</span> <span class="o">=</span> <span class="n">contrib</span><span class="p">(</span><span class="n">plaquette</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">contrib_retour</span> <span class="o">=</span> <span class="n">contrib</span><span class="p">(</span><span class="n">plaquette</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">contrib_total</span> <span class="o">=</span> <span class="n">contrib_aller</span><span class="o">+</span><span class="n">contrib_retour</span>
    
    <span class="n">rsol</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">solution</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="p">:</span>
        <span class="n">rsol</span><span class="p">,</span><span class="o">*</span><span class="n">_</span><span class="o">=</span><span class="n">quad</span><span class="p">(</span><span class="n">derivee_f_lambda_8_plus</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">plaquette</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rsol</span><span class="p">,</span><span class="o">*</span><span class="n">_</span><span class="o">=</span><span class="n">quad</span><span class="p">(</span><span class="n">derivee_f_lambda_8_plus</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">solution</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">plaquette</span><span class="p">))</span> <span class="c1">#on coupe l&#39;intégrale en 2 pour éviter la discontinuité en 2pi qui met un message d&#39;avertissement</span>
        <span class="n">rsol</span> <span class="o">=</span> <span class="n">rsol</span> <span class="o">+</span><span class="n">contrib_aller</span>
    
    <span class="n">gamma_check</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">%</span><span class="n">contrib_total</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">gamma_check</span> <span class="o">-</span> <span class="n">rsol</span> <span class="o">&gt;</span> <span class="mf">1e-1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">gamma_check</span><span class="o">-</span><span class="n">rsol</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Le rejet calculé ne correspond pas au gamma&quot;</span><span class="p">)</span>
    <span class="c1">#si on est ici, c&#39;est que notre solution convient. Il faut maintenant donner l&#39;angle correspondant : si solution est entre 0 et 2pi,</span>
    <span class="c1">#c&#39;est bon, sinon on rend 4pi - sol</span>
    <span class="k">if</span> <span class="n">solution</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">solution</span>
    <span class="k">return</span> <span class="n">solution</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Yacob Ozdalkiran.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>